import "elf"

rule Mirai_elf
{
	meta:
		id = "7l70lmrOd3eODntFXErUij"
		fingerprint = "ff117ebf72e5fd27be1630e221630333ad0cff1a799becf4162cc8a0562aff63"
		version = "1.0"
		first_imported = "2021-03-17"
		last_modified = "2021-03-17"
		status = "RELEASED"
		sharing = "TLP:WHITE"
		source = "CCCS"
		author = "reveng@CCCS"
		description = "Yara rule to detect Mirai."
		category = "MALWARE"
		malware = "MIRAI"
		malware_type = "BOT"
		hash = "5003eb173d550e96ff1b44e3212b6f91c9475dd0cf0987b2635422de7becebca"

	strings:
		$str1 = "busybox" xor
		$str2 = "watchdog" xor
		$str3 = "set-cookie:" xor

	condition:
		all of ($str*) and
		for any i in (0..elf.number_of_sections-1):
			(elf.sections[i].name == ".rodata" and
			for 3 of ($str*) :
				(@ >= elf.sections[i].offset and @< elf.sections[i].offset+elf.sections[i].size))
}
       